## *************************************************************************************
AIC = NULL
logLik = NULL
Model = c("ID", "CS", "AR(1)", "AR(1) + nugget", "UN")
AIC
logLik
AIC = NULL
logLik = NULL
Model = c("ID", "CS", "AR(1)", "AR(1) + nugget", "UN")
## independent uncorrelated random plots
full_indy = gls(y ~ factweek * (Replicate + variety), sorghum)
anova(full_indy)
AIC = c(AIC, AIC(full_indy))
logLik = c(logLik, logLik(full_indy))
## corCompSymm compound symmetry
corCompSymm = gls(y ~ factweek * (Replicate + variety),
corr = corCompSymm(form = ~ varweek|factplot), sorghum)
anova(corCompSymm)
AIC = c(AIC, AIC(corCompSymm))
logLik = c(logLik, logLik(corCompSymm))
Variogram(corCompSymm)
## corExp without nugget
corExp = gls(y ~ factweek * (Replicate + variety),
corr = corExp(form = ~ varweek|factplot), sorghum)
anova(corExp)
AIC = c(AIC, AIC(corExp))
logLik = c(logLik, logLik(corExp))
Variogram(corExp)
##  corExp with nugget
corExp_nugget = gls(y ~ factweek * (Replicate + variety),
corr = corExp(form = ~ varweek|factplot, nugget = TRUE), sorghum)
anova(corExp_nugget)
AIC = c(AIC, AIC(corExp_nugget))
logLik = c(logLik, logLik(corExp_nugget))
Variogram(corExp)
##  corSymm unstructured
corSymm = gls(y ~ factweek * (Replicate + variety), corr = corSymm(form = ~ 1|factplot),
weights = varIdent(form = ~ 1|varweek), sorghum)
anova(corSymm)
AIC = c(AIC, AIC(corSymm))
logLik = c(logLik, logLik(corSymm))
Variogram(corSymm)
AIC
AIC[4]
AIC - AIC[4]
logLik
Model
dAIC = AIC - AIC[4]
logLik = -2 * logLik
dlogLik = logLik - logLik[4]
AICtable = data.frame(Model, round(logLik, 2), round(dlogLik, 2), round(AIC, 2), round(dAIC, 2))
colnames(AICtable) = c("Covar_Model", "-2logLr", "-diff2logLr", "AIC", "diffAIC")
AICtable
fm1.1.Summary
fm4.5.glance
fm4.1.glance
cbind(fm4.1.glance, fm4.1.glance)
rbind(fm4.1.glance, fm4.1.glance)
rbind(fm4.1.glance, fm4.2.glance)
rbind(fm4.1.glance, fm4.2.glance, fm4.3.glance, fm4.4.glance)
fm4.1 <- nlme::gls(y ~ factweek * (Replicate + variety), sorghum)
fm4.1.ANOVA <- anova(fm4.1)
fm4.1.glance <- broom::glance(fm4.1)
fm4.2 <- nlme::gls(y ~ factweek * (Replicate + variety),
corr = corCompSymm(form = ~ varweek|factplot), sorghum)
fm4.2.ANOVA <- anova(fm4.2)
fm4.2.glance <- broom::glance(fm4.2)
fm4.2.Variogram <- Variogram(fm4.2)
fm4.3 <- nlme::gls(y ~ factweek * (Replicate + variety),
corr = corExp(form = ~ varweek|factplot), sorghum)
fm4.3.ANOVA <- anova(fm4.3)
fm4.3.glance <- broom::glance(fm4.3)
fm4.3.Variogram <- Variogram(fm4.3)
fm4.4.ANOVA <- anova(fm4.4)
fm4.4.glance <- broom::glance(fm4.4)
fm4.4.Variogram <- Variogram(fm4.4)
fm4.4 <- nlme::gls(y ~ factweek * (Replicate + variety),
corr = corExp(form = ~ varweek|factplot, nugget = TRUE), sorghum)
fm4.4.ANOVA <- anova(fm4.4)
fm4.4.glance <- broom::glance(fm4.4)
fm4.4.Variogram <- Variogram(fm4.4)
fm4.5 <- nlme::gls(y ~ factweek * (Replicate + variety), corr = corSymm(form = ~ 1|factplot),
weights = varIdent(form = ~ 1|varweek), sorghum)
fm4.5.ANOVA <- anova(fm4.5)
fm4.5.glance <- broom::glance(fm4.5)
fm4.5.Variogram <- Variogram(fm4.5)
dplyr::rbind_all(
fm4.1.glance
, fm4.2.glance
, fm4.3.glance
, fm4.3.glance
, fm4.5.glance
)
rbind(
fm4.1.glance
, fm4.2.glance
, fm4.3.glance
, fm4.3.glance
, fm4.5.glance
)
Model
Model <- c("ID", "CS", "AR(1)", "AR(1) + nugget", "UN")
Model
c(Model,
rbind(
fm4.1.glance
, fm4.2.glance
, fm4.3.glance
, fm4.3.glance
, fm4.5.glance
)
)
cbind(Model,
rbind(
fm4.1.glance
, fm4.2.glance
, fm4.3.glance
, fm4.3.glance
, fm4.5.glance
)
)
tibble(Model,
rbind(
fm4.1.glance
, fm4.2.glance
, fm4.3.glance
, fm4.3.glance
, fm4.5.glance
)
)
tibble(cbind(Model,
rbind(
fm4.1.glance
, fm4.2.glance
, fm4.3.glance
, fm4.3.glance
, fm4.5.glance
)
))
cbind(Model,
rbind(
fm4.1.glance
, fm4.2.glance
, fm4.3.glance
, fm4.3.glance
, fm4.5.glance
)
)
Models.Summary <-
cbind(Model,
rbind(
fm4.1.glance
, fm4.2.glance
, fm4.3.glance
, fm4.3.glance
, fm4.5.glance
))
Models.Summary
knitr::kable(
x         = Models.Summary
, format    = c("latex", "html", "markdown", "pandoc", "rst")[1]
, digits    = c(3, 0, 0)
, row.names = FALSE
, caption   = "Model Summary"
, booktabs  = TRUE
, longtable = FALSE
) %>%
row_spec(row = 0, bold = TRUE, italic = TRUE) %>%
# column_spec(column = 1, bold = FALSE, italic = TRUE, color = "black") %>%
kable_styling(latex_options = c("hold_position"))
Models.Summary
knitr::kable(
x         = Models.Summary
, format    = c("latex", "html", "markdown", "pandoc", "rst")[1]
, digits    = c(0, 3, 0, 3, 3, 3, 0)
, row.names = FALSE
, caption   = "Model Summary"
, booktabs  = TRUE
, longtable = FALSE
) %>%
row_spec(row = 0, bold = TRUE, italic = TRUE) %>%
# column_spec(column = 1, bold = FALSE, italic = TRUE, color = "black") %>%
kable_styling(latex_options = c("hold_position"))
broom::tidy(fm4.6)
##----fm4.6----
fm4.6 <- nlme::gls(y ~ (factblock+variety) * (varweek + I(varweek^2) + I(varweek^3) + I(varweek^4)),
corr = corExp(form = ~ varweek | factplot, nugget = TRUE), sorghum)
anova(fm4.6)
broom::tidy(fm4.6)
fm4.6.Par <-
tibble::tibble(
"Parameter" = c("Range", "Nugget", "rho")
, "Value"     = c(
coef(fm4.6$modelStruct$corStruct, unconstrained = FALSE)[1]
, coef(fm4.6$modelStruct$corStruct, unconstrained = FALSE)[2]
, (1-coef(fm4.6$modelStruct$corStruct, unconstrained = FALSE)[2])*
exp(-1/coef(fm4.6$modelStruct$corStruct, unconstrained = FALSE)[1])
)
)
ACF(fm4.6)
plot(fm4.6,sub.caption = NA, main = "Residuals from full polynomial weeks model")
##----fm4.6----
fm4.6 <- nlme::gls(y ~ (factblock+variety) * (varweek + I(varweek^2) + I(varweek^3) + I(varweek^4)),
corr = corExp(form = ~ varweek | factplot, nugget = TRUE), sorghum)
fm4.6.ANOVA <- anova(fm4.6)
fm4.6.Coef <- broom::tidy(fm4.6)
fm4.6.vcov <- vcov(fm4.6)
fm4.6.Par <-
tibble::tibble(
"Parameter" = c("Range", "Nugget", "rho")
, "Value"     = c(
coef(fm4.6$modelStruct$corStruct, unconstrained = FALSE)[1]
, coef(fm4.6$modelStruct$corStruct, unconstrained = FALSE)[2]
, (1-coef(fm4.6$modelStruct$corStruct, unconstrained = FALSE)[2])*
exp(-1/coef(fm4.6$modelStruct$corStruct, unconstrained = FALSE)[1])
)
)
fm4.6.ACF <- ACF(fm4.6)
fm4.6.ACF
plot(fm4.6.ACF)
autoplot(fm4.6.ACF)
ggplot2::autoplot(fm4.6.ACF)
plot(fm4.6.ACF)
Variogram(fm4.1)
fm4.1.Variogram <- Variogram(fm4.1)
ACF(fm4.1)
fm4.6.ANOVA
knitr::kable(
x         = fm4.6.ANOVA
, format    = c("latex", "html", "markdown", "pandoc", "rst")[1]
, digits    = c(0, 1, 3, 3)
, row.names = TRUE
, caption   = "ANOVA Table"
, booktabs  = TRUE
, longtable = FALSE
) %>%
row_spec(row = 0, bold = TRUE, italic = TRUE) %>%
# column_spec(column = 1, bold = FALSE, italic = TRUE, color = "black") %>%
kable_styling(latex_options = c("hold_position"))
fm4.6.Coef
knitr::kable(
x         = fm4.6.Coef
, format    = c("latex", "html", "markdown", "pandoc", "rst")[1]
, digits    = c(0, 3, 3, 3, 3)
, row.names = TRUE
, caption   = "Model Coefficients"
, booktabs  = TRUE
, longtable = FALSE
) %>%
row_spec(row = 0, bold = TRUE, italic = TRUE) %>%
# column_spec(column = 1, bold = FALSE, italic = TRUE, color = "black") %>%
kable_styling(latex_options = c("hold_position"))
fm4.6.vcov
fm4.6.Par
knitr::kable(
x         = fm4.6.Par
, format    = c("latex", "html", "markdown", "pandoc", "rst")[1]
, digits    = c(0, 3)
, row.names = FALSE
, caption   = "Structured Parameters"
, booktabs  = TRUE
, longtable = FALSE
) %>%
row_spec(row = 0, bold = TRUE, italic = TRUE) %>%
# column_spec(column = 1, bold = FALSE, italic = TRUE, color = "black") %>%
kable_styling(latex_options = c("hold_position"))
?example4
?ACF
fm4.1.Variogram <- nlme::Variogram(fm4.1)
fm4.1.Variogram
cite()
citation()
citation("ggplot2")
citation("stability")
citation("bayesammi")
install.packages("agriTutorial")
library(agriTutorial)
?exampl
?example1
library(stability)
data(ge_data)
library(tidyverse)
df1 <-
ge_data %>%
dplyr::select(Gen, Rep, Env, Yield) %>%
dplyr::rename(
G   = Gen
, Rep = Rep
, E   = Env
, Y   = Yield
) %>%
tibble::as.tibble()
ammi_biplot(
.data = df1
, .y    = Y
, .rep  = Rep
, .gen  = G
, .env  = E
)
getwd()
gge_biplot(
.data = df1
, .y    = Y
, .rep  = Rep
, .gen  = G
, .env  = E
)
str(ge_data)
install.packages("stability", type = "source")
install.packages("stability", type = "source")
library(stability)
library(emmeans)
args(emmeans)
cat(gsub(pattern=",", replacement="\n\t,", x=formatR:::usage(emmeans)))
insta
install.packages("formatR")
cat(gsub(pattern = ",", replacement = "\n\t,", x = formatR:::usage(emmeans)))
library(emmeans)
noise.lm <- lm(noise ~ size * type * side, data = auto.noise)
anova(noise.lm)
emmeans(
object     =  noise.lm
, specs      = pairwise ~ size
, by         = NULL
, fac.reduce = function(coefs) apply(coefs, 2, mean)
#    , contr      =
, options    = get_emm_option("emmeans")
#    , weights
#    , offset
#    , trend
#    , ...
)
emmeans::emmeans(
object     =  noise.lm
, specs      = pairwise ~ size
, by         = NULL
, fac.reduce = function(coefs) apply(coefs, 2, mean)
#    , contr      =
, options    = get_emm_option("emmeans")
#    , weights
#    , offset
#    , trend
#    , ...
)
pigs.lm1 <- lm(log(conc) ~ source + factor(percent), data = pigs)
pigs.lm2 <- lm(log(conc) ~ source + percent, data = pigs)
pigs.lm1 <- lm(log(conc) ~ source + factor(percent), data = pigs)
emmeans::emmeans(
object     =  pigs.lm1
, specs      = percent
, by         = NULL
, fac.reduce = function(coefs) apply(coefs, 2, mean)
#    , contr      =
, options    = get_emm_option("emmeans")
#    , weights
#    , offset
#    , trend
#    , ...
)
emmeans::emmeans(
object     =  pigs.lm1
, specs      = "percent"
, by         = NULL
, fac.reduce = function(coefs) apply(coefs, 2, mean)
#    , contr      =
, options    = get_emm_option("emmeans")
#    , weights
#    , offset
#    , trend
#    , ...
)
cat(gsub(pattern = ",", replacement = "\n\t,", x = formatR:::usage(emmip)))
emmip(
object  = pigs.lm1
, formula = source ~ percent
#  , ...
)
emmip(
object  = pigs.lm1
, formula = ~ percent | source
, CIs = TRUE
) +
geom_point(aes(x = factor(percent), y = log(conc)), data = pigs, pch = 2, color = "blue")
library(ggplot2)
emmip(
object  = pigs.lm1
, formula = ~ percent | source
, CIs = TRUE
) +
geom_point(aes(x = factor(percent), y = log(conc)), data = pigs, pch = 2, color = "blue")
devtools::install_github("rvlenth/emmeans", dependencies = TRUE,
build_vignettes = TRUE)
devtools::install_github("rvlenth/emmeans", dependencies = TRUE,
build_vignettes = TRUE)
devtools::install_github("rvlenth/emmeans", dependencies = TRUE,
build_vignettes = F)
library(emmeans)
library(emmeans)
?emmeans
Fertilizer <- c(100, 200, 400, 500)
Production <- c( 70,  70,  80, 100)
df1        <- data.frame(Fertilizer, Production)
df1
fm1 <- lm(formula = Production ~ Fertilizer, data = df1)
summary(fm1)
# Fertilizer (Kg)
# Rainfall (mm)
# Yield (Kg)
Fertilizer <- seq(from = 100, to = 700, by = 100)
Rainfall   <- c(10, 20, 10, 30, 20, 20, 30)
Yield      <- c(40, 50, 50, 70, 65, 65, 80)
df4        <- data.frame(Fertilizer, Rainfall, Yield)
df4
fm4 <- lm(formula = Yield ~ Fertilizer + Rainfall, data = df4)
summary(fm4)
Yield   <- c(5, 6, 7, 15, 16, 17)
Variety <- c("V1", "V1", "V1", "V2", "V2", "V2")
df6     <- data.frame(Yield, Variety)
df6
Variety
fm6 <- lm(formula = Yield ~ Variety, data = df6)
anova(fm6)
library(stability)
library(help = stability)
?ge_data
head(ge_data)
ge_data
add_anova(
.data = ge_data
, .y    = Yield
, .rep  = Rep
, .gen  = Gen
, .env  = Env
)
add_anova(
.data = ge_data
, .y    = Yield
, .rep  = Rep
, .gen  = Gen
, .env  = Env
)
ammi_biplot(
.data = ge_data
, .y    = Yield
, .rep  = Rep
, .gen  = Gen
, .env  = Env
)
gge_biplot(
.data = ge_data
, .y    = Yield
, .rep  = Rep
, .gen  = Gen
, .env  = Env
)
ge_data %>%
dplyr::group_by(Gen) %>%
dplyr::summarise(mean(Yield))
library(tidyverse)
ge_data %>%
dplyr::group_by(Gen) %>%
dplyr::summarise(mean(Yield))
ge_data %>%
dplyr::group_by(Gen) %>%
dplyr::summarise(Mean = mean(Yield)) %>%
dplyr::arrange(-Mean)
ge_data %>%
dplyr::group_by(Gen) %>%
dplyr::summarise(Mean = mean(Yield)) %>%
dplyr::arrange(Mean)
df1 <- read.csv(file = "/home/myaseen/Downloads/dataofagronomicresearchinstitutefaisalabad/Dr. Rafiq Cotton data for Stat Training.csv", header = TRUE)
df1
head(df1)
df1
fm1 <- lm(formula = Yield ~ Treatments, data = df1)
anova(fm1)
# rm(list = ls())
setwd("/media/myaseen/Documents/MYaseen208/Consultancy_at_UAF/Mr._M._Yaseen/2018-04-20_Website/MYaseen208")
getwd()
library(blogdown)
# Removing public directory
unlink(x = "public", recursive = TRUE, force = FALSE)
blogdown::serve_site()
# rm(list = ls())
setwd("/media/myaseen/Documents/MYaseen208/Consultancy_at_UAF/Mr._M._Yaseen/2018-04-20_Website/MYaseen208")
getwd()
library(blogdown)
# Removing public directory
unlink(x = "public", recursive = TRUE, force = FALSE)
blogdown::serve_site()
# Removing public directory
unlink(x = "public", recursive = TRUE, force = FALSE)
blogdown::serve_site()
update.packages(ask = FALSE, checkBuilt = TRUE)
devtools::install_github('rstudio/blogdown')
devtools::install_github("hadley/tidyverse")
# rm(list = ls())
setwd("/media/myaseen/Documents/MYaseen208/Consultancy_at_UAF/Mr._M._Yaseen/2018-04-20_Website/MYaseen208")
getwd()
library(blogdown)
# Removing public directory
unlink(x = "public", recursive = TRUE, force = FALSE)
blogdown::serve_site()
devtools::install_github("rstudio/radix")
devtools::install_github("r-lib/devtools")
# rm(list = ls())
setwd("/media/myaseen/Documents/MYaseen208/Consultancy_at_UAF/Mr._M._Yaseen/2018-04-20_Website/MYaseen208")
getwd()
library(blogdown)
# Removing public directory
unlink(x = "public", recursive = TRUE, force = FALSE)
blogdown::serve_site()
